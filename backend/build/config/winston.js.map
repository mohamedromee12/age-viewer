{"version":3,"file":"winston.js","names":["fs","require","winston","winstonDaily","logDir","process","env","LOG_DIR","_winston$format","format","combine","timestamp","printf","logFormat","info","concat","level","message","existsSync","mkdirSync","infoTransport","datePattern","dirname","filename","maxFiles","zippedArchive","errorTransport","logger","createLogger","transports","stream","write","NODE_ENV","add","Console","colorize","simple","module","exports"],"sources":["../../src/config/winston.js"],"sourcesContent":["/*\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\nconst fs = require('fs');\nconst winston = require('winston');\nconst winstonDaily = require('winston-daily-rotate-file');\n\nconst logDir = process.env.LOG_DIR || 'logs';\nconst { combine, timestamp, printf } = winston.format;\n\nconst logFormat = printf((info) => {\n    return `${info.timestamp} ${info.level}: ${info.message}`;\n});\n\nif (!fs.existsSync(logDir)) {\n    fs.mkdirSync(logDir);\n}\n\nconst infoTransport = new winstonDaily({\n    level: 'info',\n    datePattern: 'YYYY-MM-DD',\n    dirname: logDir,\n    filename: 'info.%DATE%.log',\n    maxFiles: 15,\n    zippedArchive: true,\n});\n\nconst errorTransport = new winstonDaily({\n    level: 'error',\n    datePattern: 'YYYY-MM-DD',\n    dirname: logDir + '/error',\n    filename: 'error.%DATE%.log',\n    maxFiles: 15,\n    zippedArchive: true,\n});\n\nconst logger = winston.createLogger({\n    format: combine(\n        timestamp({\n            format: 'YYYY-MM-DD HH:mm:ss',\n        }),\n        logFormat\n    ),\n    transports: [infoTransport, errorTransport],\n});\n\nconst stream = {\n    write: (message) => {\n        logger.info(message);\n    },\n};\n\nif (process.env.NODE_ENV !== 'production') {\n    logger.add(\n        new winston.transports.Console({\n            format: winston.format.combine(winston.format.colorize(), winston.format.simple()),\n        })\n    );\n}\n\nmodule.exports = { logger, stream };\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAMA,EAAE,GAAGC,OAAO,CAAC,IAAI,CAAC;AACxB,IAAMC,OAAO,GAAGD,OAAO,CAAC,SAAS,CAAC;AAClC,IAAME,YAAY,GAAGF,OAAO,CAAC,2BAA2B,CAAC;AAEzD,IAAMG,MAAM,GAAGC,OAAO,CAACC,GAAG,CAACC,OAAO,IAAI,MAAM;AAC5C,IAAAC,eAAA,GAAuCN,OAAO,CAACO,MAAM;EAA7CC,OAAO,GAAAF,eAAA,CAAPE,OAAO;EAAEC,SAAS,GAAAH,eAAA,CAATG,SAAS;EAAEC,MAAM,GAAAJ,eAAA,CAANI,MAAM;AAElC,IAAMC,SAAS,GAAGD,MAAM,CAAC,UAACE,IAAI,EAAK;EAC/B,UAAAC,MAAA,CAAUD,IAAI,CAACH,SAAS,OAAAI,MAAA,CAAID,IAAI,CAACE,KAAK,QAAAD,MAAA,CAAKD,IAAI,CAACG,OAAO;AAC3D,CAAC,CAAC;AAEF,IAAI,CAACjB,EAAE,CAACkB,UAAU,CAACd,MAAM,CAAC,EAAE;EACxBJ,EAAE,CAACmB,SAAS,CAACf,MAAM,CAAC;AACxB;AAEA,IAAMgB,aAAa,GAAG,IAAIjB,YAAY,CAAC;EACnCa,KAAK,EAAE,MAAM;EACbK,WAAW,EAAE,YAAY;EACzBC,OAAO,EAAElB,MAAM;EACfmB,QAAQ,EAAE,iBAAiB;EAC3BC,QAAQ,EAAE,EAAE;EACZC,aAAa,EAAE;AACnB,CAAC,CAAC;AAEF,IAAMC,cAAc,GAAG,IAAIvB,YAAY,CAAC;EACpCa,KAAK,EAAE,OAAO;EACdK,WAAW,EAAE,YAAY;EACzBC,OAAO,EAAElB,MAAM,GAAG,QAAQ;EAC1BmB,QAAQ,EAAE,kBAAkB;EAC5BC,QAAQ,EAAE,EAAE;EACZC,aAAa,EAAE;AACnB,CAAC,CAAC;AAEF,IAAME,MAAM,GAAGzB,OAAO,CAAC0B,YAAY,CAAC;EAChCnB,MAAM,EAAEC,OAAO,CACXC,SAAS,CAAC;IACNF,MAAM,EAAE;EACZ,CAAC,CAAC,EACFI,SACJ,CAAC;EACDgB,UAAU,EAAE,CAACT,aAAa,EAAEM,cAAc;AAC9C,CAAC,CAAC;AAEF,IAAMI,MAAM,GAAG;EACXC,KAAK,EAAE,SAAAA,MAACd,OAAO,EAAK;IAChBU,MAAM,CAACb,IAAI,CAACG,OAAO,CAAC;EACxB;AACJ,CAAC;AAED,IAAIZ,OAAO,CAACC,GAAG,CAAC0B,QAAQ,KAAK,YAAY,EAAE;EACvCL,MAAM,CAACM,GAAG,CACN,IAAI/B,OAAO,CAAC2B,UAAU,CAACK,OAAO,CAAC;IAC3BzB,MAAM,EAAEP,OAAO,CAACO,MAAM,CAACC,OAAO,CAACR,OAAO,CAACO,MAAM,CAAC0B,QAAQ,CAAC,CAAC,EAAEjC,OAAO,CAACO,MAAM,CAAC2B,MAAM,CAAC,CAAC;EACrF,CAAC,CACL,CAAC;AACL;AAEAC,MAAM,CAACC,OAAO,GAAG;EAAEX,MAAM,EAANA,MAAM;EAAEG,MAAM,EAANA;AAAO,CAAC"}